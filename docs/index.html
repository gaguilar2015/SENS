<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.309">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gian Aguilar">
<meta name="dcterms.date" content="2022-04-29">

<title>Gian Aguilar - Sample Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Gian Aguilar</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#structure-of-exported-data" id="toc-structure-of-exported-data" class="nav-link" data-scroll-target="#structure-of-exported-data">Structure of Exported Data</a></li>
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation">Preprocessing</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-packages" id="toc-installing-and-loading-packages" class="nav-link" data-scroll-target="#installing-and-loading-packages">Installing and loading packages</a></li>
  <li><a href="#importing-merging-and-preparing-survey-files" id="toc-importing-merging-and-preparing-survey-files" class="nav-link" data-scroll-target="#importing-merging-and-preparing-survey-files">Importing, merging and preparing survey files</a></li>
  <li><a href="#housekeeping-and-preliminary-exploratory-analysis" id="toc-housekeeping-and-preliminary-exploratory-analysis" class="nav-link" data-scroll-target="#housekeeping-and-preliminary-exploratory-analysis">Housekeeping and Preliminary Exploratory Analysis</a></li>
  <li><a href="#aesthetics" id="toc-aesthetics" class="nav-link" data-scroll-target="#aesthetics">Aesthetics</a></li>
  </ul></li>
  <li><a href="#module-1-demography" id="toc-module-1-demography" class="nav-link" data-scroll-target="#module-1-demography">Module 1: Demography</a>
  <ul class="collapse">
  <li><a href="#household-response" id="toc-household-response" class="nav-link" data-scroll-target="#household-response">Household Response</a></li>
  <li><a href="#household-totals" id="toc-household-totals" class="nav-link" data-scroll-target="#household-totals">Household Totals</a></li>
  <li><a href="#household-size" id="toc-household-size" class="nav-link" data-scroll-target="#household-size">Household Size</a></li>
  <li><a href="#population-pyramid" id="toc-population-pyramid" class="nav-link" data-scroll-target="#population-pyramid">Population Pyramid</a></li>
  </ul></li>
  <li><a href="#module-2-anthropometry-and-health" id="toc-module-2-anthropometry-and-health" class="nav-link" data-scroll-target="#module-2-anthropometry-and-health">Module 2: Anthropometry and Health</a>
  <ul class="collapse">
  <li><a href="#counts-and-summaries" id="toc-counts-and-summaries" class="nav-link" data-scroll-target="#counts-and-summaries">Counts and Summaries</a></li>
  <li><a href="#wasting" id="toc-wasting" class="nav-link" data-scroll-target="#wasting">Wasting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sample Data Analysis</h1>
<p class="subtitle lead">For a Survey Solutions SENS survey</p>
</div>





<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gian Aguilar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 29, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The <a href="https://sens.unhcr.org">Standardised Expanded Nutrition Survey</a> (SENS) is a health and nutrition survey by the United Nation’s High Commission for Refugees (UNHCR), aimed at improving nutrition among refugee populations by gathering quality data to develop timely policies and interventions.</p>
<p><a href="https://mysurvey.solutions/en/">Survey Solutions</a> is a free software developed by the World Bank for designing and managing surveys, censuses and data collection activities. It supports many modes of collection such as CAPI, CAWI and mixed-modes.</p>
<p>This document provides a brief guide to preparing SENS data for data analysis when the data-source is Survey Solutions. It assumes that the reader is familiar with Survey Solutions and has implemented (or will implement) a SENS activity using the standard Survey Solutions SENS template <em>(will be linked when public).</em></p>
<p>The statistical software that will be used in this guide is R, an open-source language for graphical and statistical computing. All examples and code will be written in R, with the assistance of some key packages. All code was developed and tested using the R <strong>version 4.1.1</strong>. Please ensure that your local R installation is version 4 or higher.</p>
<p><strong>Note</strong>: In its current form, this guide assumes <em>no particular survey design</em> and thus includes no design elements such as survey weights, strata, clusters, etc. However, the <code>survey</code> R package may be used in order to define and incorporate these elements into the analysis.</p>
<p>In addition, this guide will make heavy use of the <a href="https://www.tidyverse.org/packages/"><em>Tidyverse</em></a>, which is a set of packages and style-guidelines for data analysis in R. The two main Tidyverse packages used in this guide are <code>dplyr</code>, for data wrangling, and <code>ggplot2</code>, for plots and graphs. The <a href="#preparation">‘R Code: Preparation’</a> section contains more information about these and other R packages used in this guide.</p>
</section>
<section id="structure-of-exported-data" class="level2">
<h2 class="anchored" data-anchor-id="structure-of-exported-data">Structure of Exported Data</h2>
<p>The first step is exporting and downloading the survey data from Survey Solutions. The details of exporting data will not be discussed here but documentation can be found in the <a href="https://docs.mysurvey.solutions/headquarters/export/">official Survey Solutions documentation site</a>.</p>
<p>The image below displays all survey and system-generated files that are extracted from the Survey Solutions export.</p>
<p><img src="images/Screen%20Shot%202022-05-14%20at%2020.44.50.png" class="img-fluid" width="285"></p>
<p>For this guide, the files have been exported and downloaded in SPSS format. The main survey files are:</p>
<ul>
<li>sens.sav - the base file containing household-level elements. The modules included at this level are
<ul>
<li>Demography (M. 1)</li>
<li>Food Security (M. 5)</li>
<li>Mosquito Net (M. 6)</li>
<li>WASH (M. 7)</li>
</ul></li>
<li>HHMEMBERS.sav - the individual-level file containing individual-level elements. These include child and woman questionnaire data and modules:
<ul>
<li>Anthropometry &amp; Health (M. 2) - Child and Woman</li>
<li>Anaemia (M. 3) - Child and Woman</li>
<li>IYCF (m. 4) - Child.</li>
</ul></li>
<li>BEDNETS.sav - information on bed nets from the Mosquito Nets module.</li>
<li>WATERCONTAINERS.sav - information on household water storage containers from the WASH module.</li>
</ul>
<p>Additionally, some automatically generated metadata files are included. For information on these system-generated Survey Solutions files, <a href="https://docs.mysurvey.solutions/headquarters/export/system-generated---export-file-anatomy/">please refer to the official documentation</a>.</p>
</section>
<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">Preprocessing</h2>
<section id="installing-and-loading-packages" class="level3">
<h3 class="anchored" data-anchor-id="installing-and-loading-packages">Installing and loading packages</h3>
<p>Several very useful R packages will be used in this guide. These should be installed (if not done so already) and then loaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To install the packages used in this guide, uncomment and run the lines below.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(haven)      # For importing SPSS files into R</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(janitor)    # For cleaning/housekeeping datasets</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(dplyr)      # For wrangling and summarising datasets</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(tidyr)      # For reshaping datasets</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(ggplot2)    # For plotting and visualization</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(questionr)  # For easy frequency and descrptive tables</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(forcats)    # For working with 'factor' or categorical data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(kableExtra) # For formatting pretty tables</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-merging-and-preparing-survey-files" class="level3">
<h3 class="anchored" data-anchor-id="importing-merging-and-preparing-survey-files">Importing, merging and preparing survey files</h3>
<p>It is assumed that you have downloaded and extracted the SENS survey files into a folder called <code>SENS_FILES</code> in your local working directory. These files can now be worked with. What follows in this subsection is some basic preparation of the survey data to facilitate further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. import files from local directory, save as R data frames</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sens_hh <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">'./SENS_FILES/sens.sav'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sens_ind <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">'./SENS_FILES/HHMEMBERS.sav'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. merge household and individual level data frames</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sens_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sens_hh, sens_ind, <span class="at">by =</span> <span class="st">'interview__key'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the above code, two things take place:</p>
<ol type="1">
<li>The survey base/household-level file and the individual-level file are imported using the <code>read_sav</code> function from the <code>haven</code> packaged and saved in R objects as <em>data frames</em>.</li>
<li>The household and individual level data frames are merged*, using <code>dplyr</code>’s <code>left_join</code> function, into a single data frame named <code>sens_df</code>.
<ul>
<li>The joining variable is <em>interview__key</em>, which is a key generated by Survey Solutions to uniquely identify interview cases. In this particular context, the <em>interview__key</em> is unique at the household level, meaning that each survey household can be distinctly identified by its <em>interview__key</em>. This key is present in all survey files (and other exported files), making it a convenient merging variable. Individuals from the sens_ind roster will be merged with the household file, creating a dataset that contains all surveyed individuals along with household-level data.</li>
</ul></li>
</ol>
<p>*For more information on merges and joins with <code>dplyr</code>, <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">see here</a>.</p>
<p>Below, we create some important derived variables that will be used throughout the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. add household-size categorical variable</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sens_hh <span class="ot">&lt;-</span> <span class="fu">mutate</span>(sens_hh, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">HHSIZE_CAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                    HHSIZE <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">'1-4'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                    HHSIZE <span class="sc">&lt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'5-6'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                    HHSIZE <span class="sc">&lt;=</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">'7-9'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                    HHSIZE <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">'&gt;= 10'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create AGEGROUP variable in the individual-level data frame</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2a. define the age group labels at 5 year intervals</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>groupLabels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">90</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="fu">seq</span>(<span class="dv">0</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">95</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">sep =</span> <span class="st">"-"</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">'95+'</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2b. create the AGEGROUP variable by 5 year intervals and apply group labels</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>AGEGROUP <span class="ot">&lt;-</span> <span class="fu">cut</span>(sens_df<span class="sc">$</span>HHMAGE, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">95</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="cn">Inf</span>),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> groupLabels, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">right =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 2c. ensure correct ordering of the age group 'levels'</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>AGEGROUP <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(sens_df<span class="sc">$</span>AGEGROUP, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'0-4'</span>, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'5-9'</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. create CHILD age group variables using a different and, for</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># this purpose, more convenient approach</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>sens_df <span class="ot">&lt;-</span> <span class="fu">mutate</span>(sens_df,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">CHAGEGROUP =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">48</span><span class="sc">:</span><span class="dv">59</span> <span class="sc">~</span> <span class="st">'48-59'</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">36</span><span class="sc">:</span><span class="dv">47</span> <span class="sc">~</span> <span class="st">'36-47'</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">24</span><span class="sc">:</span><span class="dv">35</span> <span class="sc">~</span> <span class="st">'24-35'</span>, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">23</span> <span class="sc">~</span> <span class="st">'12-23'</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">11</span> <span class="sc">~</span> <span class="st">'6-11'</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    MONTHSX <span class="sc">%in%</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">'0-5'</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>CHAGEGROUP <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(sens_df<span class="sc">$</span>CHAGEGROUP, </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'0-5'</span>, </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'6-11'</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. create a recoded SEX variable</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>SEX <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sens_df<span class="sc">$</span>HHMSEX <span class="sc">==</span> <span class="dv">1</span>, <span class="st">'Male'</span>, <span class="st">'Female'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code above, we have derived the following important variables:</p>
<ol type="1">
<li>A derived categorical variable of household size.</li>
<li>A derived categorical (ordered) variable of individual age groups, in intervals of 5 years.</li>
<li>A derived categorical (ordered) variable of child age groups, in varying month intervals.</li>
<li>A recoded SEX variable using text labels.</li>
</ol>
</section>
<section id="housekeeping-and-preliminary-exploratory-analysis" class="level3">
<h3 class="anchored" data-anchor-id="housekeeping-and-preliminary-exploratory-analysis">Housekeeping and Preliminary Exploratory Analysis</h3>
<p>The SENS documentation recommends reviewing the completeness and integrity of some key variables. Below, we run frequency checks on the three main consent variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency on overall HOUSEHOLD consent variable</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(sens_hh[<span class="st">'MDCCONST'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     n    % val%
[1] Yes              7 63.6 63.6
[2] No               2 18.2 18.2
[3] Absent           2 18.2 18.2
[-999999999] missing 0  0.0  0.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency on overall CHILD consent variable</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(sens_ind[<span class="st">'CHCONST'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      n    % val%
[1] Yes              17 38.6 94.4
[2] No                1  2.3  5.6
[-999999999] missing  0  0.0  0.0
NA                   26 59.1   NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency on overall WOMAN consent variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(sens_ind[<span class="st">'WMCONST'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      n    % val%
[1] Yes               7 15.9 63.6
[2] No                2  4.5 18.2
[8] Absent            2  4.5 18.2
[-999999999] missing  0  0.0  0.0
NA                   33 75.0   NA</code></pre>
</div>
</div>
<p>Analysing the output of the above frequencies, we can observe a few peculiarities worth mentioning:</p>
<ul>
<li><p>System-missing data - <em>These data are coded as <strong>NA</strong> by R</em>. These are data that are missing because the software determines that they are not applicable. For example all questions that are disabled in Survey Solutions are questions that should not be asked and thus the data is missing.</p></li>
<li><p>User-missing data - <em>These data are coded as <strong>-999999999</strong> by Survey Solutions</em>. These are data intentionally or unintentionally left blank by the data-capturer. Survey Solutions codes these as -999999999 with the label ‘missing’. These correspond to questions which the software determined that they should have been asked, but no response was recorded.</p>
<ul>
<li>Some users might want to code user-missing data under the same category as options such as “Don’t know” or “Not applicable”. This depends on the particular analysis plan.</li>
</ul></li>
<li><p>Other labelled data - We can observe that for other valid data, Survey Solutions produces values and labels, which is very useful during analysis.</p></li>
</ul>
<p>Further investigation into the structure and content of the exported data can and should be done in order to become familiar with the dataset and to gain some intuition on how the data looks after being (I) created by Survey Solutions, (II) exported by Survey Solutions in SPSS format, and (III) imported into R using the Haven package.</p>
<p>The output below, which uses <code>dplyr</code>’s <code>glimpse</code> function, shows the first 30 variables of the SENS dataset. The output displays the variables going horizontally, the data type beside each variable, and a few of the data values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We select a subset of the columns of the SENS dataset to "explore"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sens_subset <span class="ot">&lt;-</span> <span class="fu">select</span>(sens_df, <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sens_subset) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 48
Columns: 30
$ interview__key   &lt;chr&gt; "09-12-74-59", "60-26-84-57", "12-79-20-21", "94-09-2…
$ interview__id.x  &lt;chr&gt; "39281449ec2d413082bb9792a80f53e5", "31e2a24e0da64d83…
$ CAMPNAME         &lt;chr&gt; "Belize Camp 2A", "Belize 3A", "Belize Camp 3A", "Bel…
$ SECTION          &lt;chr&gt; "009", "900", "567", "609", "609", "609", "001", "001…
$ ZONE             &lt;dbl+lbl&gt; 2, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…
$ BLOCK            &lt;dbl+lbl&gt; 1, 6, 3, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…
$ CLUSTER          &lt;dbl+lbl&gt;  4,  2,  2, 43, 43, 43,  2,  1,  1,  1,  1,  1,  …
$ HH               &lt;chr&gt; "2", "3", "33", "82", "82", "82", "4", "10", "10", "1…
$ SURVDAT          &lt;chr&gt; "2022-04-30T10:50:40", "2022-04-30T10:51:49", "2022-0…
$ COUNTRY          &lt;dbl+lbl&gt; 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 8…
$ IYCF             &lt;dbl+lbl&gt; NA, NA, NA, NA, NA, NA,  1,  1,  1,  1,  1,  1,  …
$ MDCCONST         &lt;dbl+lbl&gt; 2, 3, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ GPSCONST         &lt;dbl+lbl&gt; NA, NA, NA,  1,  1,  1, NA,  2,  2,  2,  2,  2,  …
$ HHGPS__Latitude  &lt;dbl+lbl&gt;       NA,       NA,       NA, 17.06893, 17.06893,…
$ HHGPS__Longitude &lt;dbl+lbl&gt;        NA,        NA,        NA, -89.13822, -89.1…
$ HHGPS__Accuracy  &lt;dbl+lbl&gt;     NA,     NA,     NA, 16.791, 16.791, 16.791,  …
$ HHGPS__Altitude  &lt;dbl+lbl&gt;    NA,    NA,    NA, 109.3, 109.3, 109.3,    NA, …
$ HHGPS__Timestamp &lt;chr&gt; "", "", "", "2022-04-30T17:01:33", "2022-04-30T17:01:…
$ HHHSEX           &lt;dbl+lbl&gt; NA, NA, NA,  2,  2,  2, NA,  1,  1,  1,  1,  1,  …
$ HHHAGE           &lt;dbl+lbl&gt; NA, NA, NA, 25, 25, 25, NA, 47, 47, 47, 47, 47, 4…
$ HHHCTRY          &lt;dbl+lbl&gt;  NA,  NA,  NA, 320, 320, 320,  NA, 222, 222, 222,…
$ HHHHOST          &lt;dbl+lbl&gt; NA, NA, NA,  2,  2,  2, NA,  2,  2,  2,  2,  2,  …
$ HHHDIP           &lt;dbl+lbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ HHHREFUG         &lt;dbl+lbl&gt; NA, NA, NA,  1,  1,  1, NA,  1,  1,  1,  1,  1,  …
$ NAME__0          &lt;chr&gt; "", "", "", "Gianni", "Gianni", "Gianni", "", "Rudy",…
$ NAME__1          &lt;chr&gt; "", "", "", "Elvira", "Elvira", "Elvira", "", "Serge"…
$ NAME__2          &lt;chr&gt; "", "", "", "Antonio", "Antonio", "Antonio", "", "Mar…
$ NAME__3          &lt;chr&gt; "", "", "", "##N/A##", "##N/A##", "##N/A##", "", "kam…
$ NAME__4          &lt;chr&gt; "", "", "", "##N/A##", "##N/A##", "##N/A##", "", "Hug…
$ NAME__5          &lt;chr&gt; "", "", "", "##N/A##", "##N/A##", "##N/A##", "", "Fri…</code></pre>
</div>
</div>
<p>Finally, we run a basic histogram below to get a sense of the age data on household members (HHMAGE). This can be useful for detecting possible outliers and for observing general trends.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sens_df, <span class="fu">aes</span>(<span class="at">x =</span> HHMAGE)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">'turquoise4'</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">95</span>, <span class="dv">5</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">95</span>, <span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (stat_bin).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="aesthetics" class="level3">
<h3 class="anchored" data-anchor-id="aesthetics">Aesthetics</h3>
<p>The code below is simply for formatting the aesthetics of the output in the rest of this guide. A few functions and objects that help us format tables and plots are created. All plots will be created using the <code>ggplot2</code> package. it is not important to understand the below code, but for more information on colors and theming in R and ggplot2, <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/colour">please see here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. function that formats a data frame using the {kableExtra} package</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>formattedTable <span class="ot">&lt;-</span> <span class="cf">function</span>(df, capt){</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption =</span> capt) <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> F,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. function that formats a decimal value into a percent value</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>formatPercent <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="fu">round</span>(x, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">'%'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. theme colors for plots</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>primaryColor <span class="ot">&lt;-</span> <span class="st">'turquoise4'</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>secondaryColor <span class="ot">&lt;-</span> <span class="st">'wheat3'</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. ggplot2 theme object for styling plots</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>plotTheme <span class="ot">&lt;-</span>   <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'bottom'</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. An overlay of percent-label text on some plots</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>applyPercentLabels <span class="ot">&lt;-</span> <span class="fu">geom_text</span>(</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y=</span>..count..<span class="sc">/</span><span class="fu">tapply</span>(..count.., ..x.. ,sum)[..x..],</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">label=</span><span class="fu">paste0</span>(<span class="fu">round</span>((..count..<span class="sc">/</span><span class="fu">tapply</span>(..count.., ..x.. ,sum)[..x..]), </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">'%'</span>)),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'white'</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat=</span><span class="st">"count"</span>, </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">position=</span><span class="fu">position_fill</span>(<span class="fl">0.5</span>), </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="module-1-demography" class="level2">
<h2 class="anchored" data-anchor-id="module-1-demography">Module 1: Demography</h2>
<section id="household-response" class="level3">
<h3 class="anchored" data-anchor-id="household-response">Household Response</h3>
<p>Response rates are calculated from the consent (<code>MDCCONST</code>) variable. The function <code>freq</code> from the <code>questionr</code> package is used to produce easy frequency tables with labelled values.</p>
<p>The result is displayed with the help of our <code>formattedTable</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. derive frequencies</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>response_freq <span class="ot">&lt;-</span> <span class="fu">freq</span>(sens_hh[<span class="st">"MDCCONST"</span>]) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. output the results in a formatted table</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">formattedTable</span>(response_freq, <span class="st">'Household Consent'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Household Consent</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> % </th>
   <th style="text-align:right;"> val% </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> [1] Yes </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 63.6 </td>
   <td style="text-align:right;"> 63.6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> [2] No </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 18.2 </td>
   <td style="text-align:right;"> 18.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> [3] Absent </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 18.2 </td>
   <td style="text-align:right;"> 18.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> [-999999999] missing </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="household-totals" class="level3">
<h3 class="anchored" data-anchor-id="household-totals">Household Totals</h3>
<p>We can also display some aggregated summaries of the surveyed population. We will call these ‘Household Totals’ and they are derived by aggregating and summing the demographic summary variables available from the Demography module. We recall that these variables were automatically calculated by Survey Solutions for each interviewed household.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. summarise survey data on household totals</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>survey_totals <span class="ot">&lt;-</span> <span class="fu">summarise</span>(sens_hh, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total Surveyed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(HHSIZE, <span class="at">na.rm =</span> T),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total U2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOTU2, <span class="at">na.rm =</span> T),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total U5</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOTU5, <span class="at">na.rm =</span> T),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total 5-14</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOT514, <span class="at">na.rm =</span> T),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total 15-64</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOT1564, <span class="at">na.rm =</span> T),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total 65+</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOT65OLD, <span class="at">na.rm =</span> T),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">`</span><span class="at">Total Pregnant</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(TOTPREG, <span class="at">na.rm =</span> T))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. pivot the table from wide to long format</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>survey_totals <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(survey_totals, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">"Household Totals"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">values_to =</span> <span class="st">"Result"</span>) </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. output the results in a formatted table</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">formattedTable</span>(survey_totals, <span class="st">'Household Totals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Household Totals</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Household Totals </th>
   <th style="text-align:right;"> Result </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Total Surveyed </td>
   <td style="text-align:right;"> 44 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total U2 </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total U5 </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total 5-14 </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total 15-64 </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total 65+ </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total Pregnant </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="household-size" class="level3">
<h3 class="anchored" data-anchor-id="household-size">Household Size</h3>
<p>Using the <code>questionr</code> package, it is also easy to produce some basic frequency tables, such as household size categories using the <code>HHSIZE_CAT</code> variable created earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>hh_sizecat <span class="ot">&lt;-</span> questionr<span class="sc">::</span><span class="fu">freq</span>(sens_hh<span class="sc">$</span>HHSIZE_CAT)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">formattedTable</span>(hh_sizecat, <span class="st">'Household Size'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Household Size</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> % </th>
   <th style="text-align:right;"> val% </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> &gt;= 10 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 18.2 </td>
   <td style="text-align:right;"> 28.6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1-4 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 27.3 </td>
   <td style="text-align:right;"> 42.9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5-6 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 18.2 </td>
   <td style="text-align:right;"> 28.6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 36.4 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>For reporting, it might be useful to create some graphs and visuals of demographic data. Below, we use the ggplot2 package to create a simple bar graph of household size frequencies.</p>
<p>For more information on ggplot2 and its syntax, refer to the <a href="https://r4ds.had.co.nz/data-visualisation.html#data-visualisation">Data Visualization chapter</a> in R For Data Science (Wickham, 2016).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep valid respondent households</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>households <span class="ot">&lt;-</span> <span class="fu">filter</span>(sens_hh, MDCCONST <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bar chart of household size frequencies</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> households, <span class="fu">aes</span>(HHSIZE_CAT)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> primaryColor) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Household Size'</span>, <span class="at">y =</span> <span class="st">'Count'</span>, <span class="at">title =</span> <span class="st">'Frequency of household size'</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  plotTheme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="population-pyramid" class="level3">
<h3 class="anchored" data-anchor-id="population-pyramid">Population Pyramid</h3>
<p>We can also create a typical population pyramid. To do this, we first derive a data frame that groups data by sex and age group. Because of how <code>ggplot2</code> renders the data, we also make the male population figures negative, so that the male pyramid bars go to side opposite of the female pyramid bars.</p>
<p>Thereafter, a somewhat complex <code>ggplot</code> function call is made to create the pyramid. Essentially, we are modifying a bar graph and applying some tricks to create the pyramid.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. derive age group populations by sex</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>agegroups <span class="ot">&lt;-</span> sens_df <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(AGEGROUP), <span class="sc">!</span><span class="fu">is.na</span>(SEX)) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEX, AGEGROUP, CAMPNAME) <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">POPULATION =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">POPULATION =</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="st">'Male'</span>, POPULATION <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>, POPULATION))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. create population pyramid</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>mainPyramid <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> agegroups, <span class="fu">aes</span>(<span class="at">x =</span> AGEGROUP, <span class="at">y =</span> POPULATION, <span class="at">fill =</span> SEX)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>) <span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(primaryColor, secondaryColor)) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(.x <span class="sc">&lt;</span> <span class="dv">0</span>, .x <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>, .x)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>    </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Population Pyramid'</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  plotTheme </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>mainPyramid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>We could also generate individual population pyramids conditioned on a particular variable - say, CAMPNAME. This can be achieved with <code>ggplot</code>’s <code>facet_wrap</code> function. Although we need a lot more data to truly appreciate this visually, the code and output is demonstrated below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># 3. create faceted population pyramid</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>mainPyramid <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> CAMPNAME, <span class="at">nrow =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="module-2-anthropometry-and-health" class="level2">
<h2 class="anchored" data-anchor-id="module-2-anthropometry-and-health">Module 2: Anthropometry and Health</h2>
<section id="counts-and-summaries" class="level3">
<h3 class="anchored" data-anchor-id="counts-and-summaries">Counts and Summaries</h3>
<p>The Anthropmetry and Health module is the first child-level module, and thus captures some demographic child data. <em>This guide assumes that the IYCF module is included</em> in the SENS survey and therefore the child age range for <strong>eligibility is 0-59 months</strong>.</p>
<p>In the code and table below, we first calculate the child (0-59 months) response rates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. summarise data by response based on the MDCCONST variable</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note: modify 'Target' to your local target # for children to sample</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>chResponse <span class="ot">&lt;-</span> sens_df <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Target =</span> <span class="dv">120</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Surveyed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(CHCONST <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">% of Target</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>((<span class="st">`</span><span class="at">Total Surveyed</span><span class="st">`</span><span class="sc">/</span>Target) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">2</span>), <span class="st">'%'</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Non-Responses</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(CHCONST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Non-Reponse rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="fu">sum</span>(CHCONST <span class="sc">!=</span> <span class="dv">1</span>, <span class="at">na.rm =</span> T)<span class="sc">/</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(CHCONST), <span class="at">na.rm =</span> T), <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">'%'</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. output the results in a formatted table</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">formattedTable</span>(chResponse, <span class="st">"Children 0-59 Months"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Children 0-59 Months</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> Target </th>
   <th style="text-align:right;"> Total Surveyed </th>
   <th style="text-align:left;"> % of Target </th>
   <th style="text-align:right;"> Non-Responses </th>
   <th style="text-align:left;"> Non-Reponse rate (%) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 120 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:left;"> 14.17% </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 5.6% </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Next, we can create an age and sex distribution of the surveyed children, including the sex ratio (girl:boy).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. derive frequency table with totals, using the {janitor} package</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>chAgeSex <span class="ot">&lt;-</span> <span class="fu">tabyl</span>(<span class="at">dat =</span> sens_df, CHAGEGROUP, SEX, <span class="at">show_na =</span> F) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">'row'</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. add percentage columns, format and rearrange columns</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>chAgeSex <span class="ot">&lt;-</span> chAgeSex <span class="sc">|&gt;</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> Female <span class="sc">+</span> Male,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">formatPercent</span>(Female<span class="sc">/</span>Total),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">% </span><span class="st">`</span> <span class="ot">=</span> <span class="fu">formatPercent</span>(Male<span class="sc">/</span>Total),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ratio =</span> <span class="fu">round</span>(Female<span class="sc">/</span>Male, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CHAGEGROUP, <span class="st">`</span><span class="at">Count</span><span class="st">`</span> <span class="ot">=</span> Female, <span class="st">`</span><span class="at">%</span><span class="st">`</span>, <span class="st">`</span><span class="at">Count </span><span class="st">`</span> <span class="ot">=</span> Male, <span class="st">`</span><span class="at">% </span><span class="st">`</span>, Total, Ratio)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#3. output results to a formatted table, grouping some columns by sex</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">formattedTable</span>(chAgeSex, <span class="st">'Child Age and Sex Distribution'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Female"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Male"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-condensed" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Child Age and Sex Distribution</caption>
 <thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Female</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Male</div></th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2"></th>
</tr>
  <tr>
   <th style="text-align:left;"> CHAGEGROUP </th>
   <th style="text-align:right;"> Count </th>
   <th style="text-align:left;"> % </th>
   <th style="text-align:right;"> Count  </th>
   <th style="text-align:left;"> %  </th>
   <th style="text-align:right;"> Total </th>
   <th style="text-align:right;"> Ratio </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0-5 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> 75% </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 25% </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6-11 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 67% </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 33% </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12-23 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 0% </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 100% </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 24-35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> 0% </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 100% </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 36-47 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 67% </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 33% </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 48-59 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 50% </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> 50% </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:left;"> 50% </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:left;"> 50% </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="wasting" class="level3">
<h3 class="anchored" data-anchor-id="wasting">Wasting</h3>
<p>Wasting is a type of acute malnutrition that is calculated from the weight-for-height or weight-for-length rations in young children. Below, we see a summary proportion bar plot of moderate and severe wasting across age groups. The WFZ (weight-for-N) score was calculated via a real-time function implemented in the Survey Solutions SENS questionnaire, and is available in the exported data. This is the primary variable used in calculating the wasting displayed below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>WFZ <span class="ot">&lt;-</span> <span class="fu">as.double</span>(sens_df<span class="sc">$</span>WFZ)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sens_df <span class="ot">&lt;-</span> sens_df <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">WASTING =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      WFZ <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">'No wasting'</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      WFZ <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">'Moderate wasting'</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      WFZ <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">'Severe wasting'</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>sens_df<span class="sc">$</span>WASTING <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(sens_df<span class="sc">$</span>WASTING, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'No wasting'</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Moderate wasting'</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Severe wasting'</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">filter</span>(sens_df, <span class="sc">!</span><span class="fu">is.na</span>(WASTING)),<span class="fu">aes</span>(<span class="at">x =</span> CHAGEGROUP, <span class="at">fill =</span> WASTING)) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">'fill'</span>) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  applyPercentLabels <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Age Group'</span>, <span class="at">y =</span> <span class="st">'Proportion'</span>, </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Prevalence of wasting by age in children 6-59 months'</span>) <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'aquamarine3'</span>, <span class="st">'salmon'</span>, <span class="st">'firebrick1'</span>)) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T)) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  plotTheme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>